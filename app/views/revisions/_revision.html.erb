<div class="item item--single mt-half">
  <div class="item__title item__title--small">
    <div>
      <% if revision != @post.revisions.first && (revision.post.user == current_user || revision.snippet.present?) %>
        <div class="dropdown mr-quarter" data-dropdown>
          <%= link_to "#", class: "dropdown__toggle", data: { action: "toggle-dropdown" } do %>
            <%= inline_svg "icons/icon-menu.svg", height: 16 %>
          <% end %>

          <div class="dropdown__content dropdown__content--left" data-dropdown-content>
            <% if revision.post.user == current_user %>
              <%= link_to "Edit Revision", edit_revision_path(revision.id), class: "dropdown__item" %>
            <% end %>

            <% if revision.snippet.present? %>
              <%= link_to "View changes in snippet", revision_path(revision.id), class: "dropdown__item" %>
              <%= link_to "View raw snippet", raw_snippet_path(revision.id, "json"), class: "dropdown__item" %>
            <% end %>
          </div>
        </div>
      <% end %>

      <%= revision.version unless revision.version.empty? %>
      <%= tag.small " (latest)" if revision.code == revision.post.code %>
    </div>

    <small class="ml-auto">
      <span title="Created at: <%= revision.created_at %>" data-role="timeago" datetime="<%= revision.created_at %>"></span>

      <% if revision.created_at < 6.months.ago %>
        <small class="tooltip">
          âš 

          <div class="tooltip__content">
            <strong>This code is over 6 months old.</strong> This might mean the code has expired and will no longer function.
          </div>
        </small>
      <% end %>
    </small>
  </div>

  <div class="item__code">
    <%= inline_svg_tag "icons/icon-copy.svg", class: "copy-trigger", data: { action: "copy-to-clipboard", target: revision.code } %>

    <span class="copy">
      <span data-copy="<%= revision.code %>" data-track-copy><%= revision.code %></span>
    </span>
  </div>
</div>

<% unless revision.description.blank? %>
  <div class="item__description mt-0">
    <%= markdown(revision.description) %>
  </div>
<% end %>
